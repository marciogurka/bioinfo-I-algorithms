import ComputingFrequencies from "./ComputingFrequencies";
import NumberToPattern from "./NumberToPattern";

/**
 * @description Find patterns forming clumps in a string.
 *
 * @param {String} genome - The DNA chain string
 * @param {Number} k - Size of the clump string to be searched
 * @param {Number} t - Minimum of number of times that the clump needs to appear in the part
 * @param {Number} L - Size of the genome string part to be searched
 * @returns All distinct k-mers forming (L, t)-clumps in Genome.
 */
function ClumpFinding(genome, k, t, L) {
  const frequentPatterns = new Set();
  const clump = [];
  for (let i = 0; i <= Math.pow(4, k) - 1; i++) {
    clump[i] = false;
  }
  for (let i = 0; i <= genome.length - L; i++) {
    const text = genome.substr(i, L);
    const frequencyArray = ComputingFrequencies(text, k);
    for (let j = 0; j <= Math.pow(4, k) - 1; j++) {
      if (frequencyArray[j] >= t) {
        clump[j] = true;
      }
    }
  }

  for (let i = 0; i <= Math.pow(4, k) - 1; i++) {
    if (clump[i]) {
      const pattern = NumberToPattern(i, k);
      frequentPatterns.add(pattern);
    }
  }

  return frequentPatterns;
}

// Example
// const text =
//   "CATGTGAAATGTGAACTTATGTGAACTAATGTGAATATGTGAAACCCATGTGAAAGGTTCAATGTGAATTATGTGAATTAATGTGAAGATAGATGTGAAATGTGAATATGTGAAATGTGAAATTGCATGTGAAGGATGTGAATATGTGAAATGTGAAATGTGAAGACATGTGAAATGTGAATCATGTGAATGCCACAGGATGTGAAGTATGTGAAATAGGGATAGCGCCAATGTGAAGCATGTGAAATGTGAAATGTGAAGATGTGAACAATGTGAAATGTGAAGCAACATGTGAAAACATGTGAATCTATGTGAAATGTGAATGAGGATGTGAAATATGTGAAGGACCGATGTGAAAAATAACATGTGAAATGTGAACATGTGAAGGATGTGAAACATGTGAAATGTGAACCATCACATGTGAAATGTGAAATGTGAAATGTGAAGGTTATGTGAATTATGCTATGTGAAATGTGAAAGATGTGAAATATGTGAAAATGTGAATCTATGTGAATGATGTGAAGCCAGGCTATGTGAAATTGATATGTGAAATGTGAATTACGTGATGTGAACATCATGTGAAAACATGTGAACATGTGAATATTTATGTGAAACATGTGAAATGTGAAATGTGAAATGTGAAATGTGAAGAGACGATGTGAAATGTGAAGAATGTGAACATGTGAATATGTGAAGGATGTGAAAACTAAGCGGATAACAATGTGAAAATGTGAAGGCCATGTGAAAATTATGTGAACTCGGATGTGAACATGTGAAATGTGAACCTCTATATGTGAACATGTGAACGAAGAACATGTGAAATGTGAAATGTGAACTATGTGAACTTGAGATGTGAAGATGTGAACGAATGTGAATGAAAGTATGTGAACTATGTGAACATGTGAATCATGTGAACAATGTGAACTCAGATGTGAAGTATGTGAAGCATGTGAAGGATGTGAACATGTGAATCTGTCATACCAATGTGAAATGTGAACATGTGAACGATGTGAACTACTATGTGAAAGAATGTGAAATGTGAAAGCTCATGTGAACATGTGAAAAATGTGAACATGTGAAGCATGTGAATTATGTGAATCTCATGTGAATTATGTGAACTGATCAGATGTGAACGCTAATGTGAAATGTGAAATGTGAAATGTGAAATGTGAAATGTGAAGATGTGAAATGTGAAAGATGTGAAATGTGAATGGAAGGCATGTGAACGAGCATGTGAAGAGCTAAAAATTCGATGTGAACATGTGAAATGTGAAATCGCGGTTCATGTGAAGGTATGTGAATCATGTGAAACTTATGTGAAATGTGAAGATGTGAAATGTGAAATGTGAAAGCATGTGAATGAAGAATGTGAACCTCATGTGAACAATGTGAACATGTGAACATATGTGAAGGATGTGAACATGTGAACCATAATGTGAAGCCTATGCAATGTGAACGGATGTGAAATGTGAAAATACTATCATGTGAAGCTTAGGATGTGAAGGATGTGAAACATGTGAAGACATCATGTGAAATGTGAAATCGATGTGAACTTCATGTGAACATGTGAAATGTGAAATATGTGAACATGTGAAAGTTCATGTGAAATGTGAAATGTGAATTGATGTGAAGGCACTTATGTGAACATATGTGAAATGTGAATATGTGAAGATGTGAAATGTGAATCAAAGCTATGTGAAATGTGAAAATGTGAAGCATGTGAACTAGCATGTGAAAGGAGTACATGTGAAACCGAGCGATGTGAAAAGGCGGATGTGAAATGTGAAAGCATGTGAAATGTGAAACTATGTGAAGTCATGTGAAATGTGAAATGTGAAGGGATGTGAAATGTGAAGATGTGAAGTATGTGAATTCTATATTATGTGAAGGATTACAATGTGAACAATGTGAAACGTGCCATGTGAATGATGTGAAACATGTGAAAGCGCTGGATGTGAAATGTGAAATGTGAATATGTGAAGATGTGAAATGTGAAATGTGAAATGTGAATATGTGAAAATGTGAACTCTATGTGAAGGAATGTGAAATGTGAAGAATCATGTGAAATGTGAATATAATGTGAAGGCATGTGAACCGTTGTATGGATGTGAAAATGTGAAATGTGAACATGTGAATGGATGTGAAATGTGAATATGTGAAAGATCGTTTCATGTGAATAGGGGATGTGAAAATGTGAATGAATGTGAAGGTAGACATTGCCATGTGAAGAATGAGCATGTGAAAGATGTGAATTATATGTGAAATGTGAAGTGTAGTATATGTGAAGATGTGAAATGTGAAGGAATGTGAAGAATGTGAAATGTGAAATGTGAAGATGTGAATATGTGAAGCATGTGAACGATGTGAAGTGTATGTGAATTATGTGAAAATGTGAAAGTATGTGAAGTTAGACATGTGAACGTATGTGAAATGTGAATGGTATTATGTGAAATGTGAAATGTGAATTCAGCAGTATGTGAAGAGATGTGAACATGTGAACTGGATCGGGCATGTGAATAAATTATGTGAATTAAGGATGTGAAATGTGAACTTATGTGAATTTCATGTGAAGTTGAGCTCATGTGAAATGTGAAAATGTGAAAGATGTGAAGATGTGAAAATGTGAAATGTGAAATGTGAATATGTGAAGTATGTGAAAAAATGTGAACCATGTGAAGTAATGTGAAGTGCCGATGTGAATATGTGAAGATGTGAACCCGGGACATGTGAAATGTGAAACAAATGTGAACACCTATGTGAAATGTGAAGCAATGTGAAGTTTAATGTGAAATGTGAAAATTGCTACATGTGAAGGGTAAAATGTGAAATGTGAACGGTACCACATGTGAAATGTGAACATGTGAACCATGTGAATTTCATGTGAAATGTGAAGATATGTGAACGTATTTGATGTGAATCTATGTGAAATATGTGAACATGTGAATTCACGTCCCGAAACCAGGAATGTGAATGATGTGAATGGATGTGAATGAGGTATGTGAAATGTGAACACCGTAATGTGAAATGTGAAATGTGAACATGTGAACATGTGAAATGTGAAATAATGTGAAATGTGAAACATGTGAAATGTGAAGGATGTGAAGATGTGAAATGTGAACACAGCGTTGAAGATGTGAAATGTGAAATGTGAACATGTGAAAAAATGTGAATCCTATGTGAAAGCTCACGATGTGAAACCGATAACGAAGCATGTGAAATGTGAAACTTTATGTGAAATCAATGTGAAATGTGAATGATGTGAAAAGATGTGAAATGTGAAAACTATGTGAAATGTGAAATGTGAATAACGATGTATGTGAATAATGTGAATGAATGTGAACATATCATGTGAAATGTGAAGAATGTGAATTCCATGTGAAGATGTGAAATGTGAAATATGTGAAATGTGAAGCATGTGAACATGTGAAAATGTGAACTATGTGAAAAATGTGAAGGGATGTGAAATGTGAAGGGAGTAGTTAATGTGAAATGTGAACCCACATGTGAACCCGGTGATGTGAAAAAGATGTGAACGCAATGTGAATACATGTGAAGCATGTGAAGCTAGATGATGTGAAGAGATGTGAACATGTGAATAGATGTGAATTAATGTGAAAAGAGCATGCATGTGAACGGCCTATGTGAAGTATGTGAATTGATCGATGTGAAATGTGAATACTCTCCACGTCGCTATGTGAAATGTGAAAATTGCACGATGTGAATACAGATGTGAAGTATGTGAAGATGTGAATTATGTGAAACATGTGAAAATGTGAAGATGTGAATTGATGTGAAATCATGTGAACATGTGAAATGTGAAATGTGAAATGTGAATCAGATGTGAAGCATGTGAAATGTGAAGGGAAATATGTGAAGAACTTGATGTGAAGGATGTGAAAGTGGAGATGTGAATTGGCTTAGATGTGAATATGTGAAGCATGTGAAACTAAAAAATGTGAAATGTGAAATGTGAAAGATGTGAAGAGCATGTGAAATGTGAAATGTGAAATGTGAAATGTGAAATGTGAATTATGTGAAGAATGTGAAATGTGAAATGTGAAATGTGAACTATGTGAAATGTGAAGGGATGTGAACTAATGTGAAGATGTGAATAAATATGTGAAGATAATGTGAAATTATGTGAACATGTGAAATGTGAAAGATGTGAAATGTGAAAAGCGAGGTATGTGAAGCTATGTGAAGAAATGTGAACATGTGAATGTTAGCCATGTGAAGATGTGAAATGTGAAAATGTGAACATGTGAACATGTGAAGATGTGAAATGTGAATAAGGGAGACAATGTGAAATGTGAAGATGTGAAATGTGAACGCAAATTTAATGTGAACATGTGAACCAGTTCTCATGTGAATGCATGTGAATTCTATGTGAACGATGTGAAATGTGAAATGTGAAGATGTGAAATGTGAATCCGGGCCGCGTATCTATGTGAACTATTATGTGAAGCATGTGAACTCGAATGTGAATCGATGTGAAAGTCAAATGTGAAGCGTGACTTAAGGATGTGAAGAGATGTGAAGCATTTGCAATGTGAAGTAATGTGAAGCATGTGAAATGTGAACATGTGAATCTATGTGAAATGTGAATTTATGTGAATTAACTATGTGAACGAGTGATGTGAAGCACCATGTGAACATCATGTGAAACAGCGATGTGAACTCAATTAGAGAATGTGAACGATGTGAAATGTGAAATGTGAAGGGAAATGTGAATCACCTCTGTGATGTGAAAATGTGAAATGTGAAGATGTGAACCTAATATGTGAAATGTGAAATGTGAACATGTGAAATGTGAAATGTGAAACGCCCATGTGAACATGTGAATCAGTGTAAGACTATGTGAATGAGATGTGAACATGTGAATTAGATGTGAAGTGACATGTGAAAATGTGAAATGTGAAATGTGAATGATGTGAAGATGTGAATAGCCGCATGTGAACATGTGAACGGACATGTGAAGGATGTGAAGTCATGTGAAAGACGGATGTGAAATGTGAAATGTGAAGATGTGAATTCTCATGTGAACTATGTGAACGGGCTAATCATTATGTGAATTGCGGGATACCGGATGTGAACAATGTGAAAATGTGAAATGTGAACTTTATATGTGAAATCATGTGAATCCTGATGAAAGATGTGAAATGTGAATACTTATGTGAAAATGTGAACTATGTGAAGATGTGAAACTATCGTTTCCTATGTGAAAAGCGTATGTGAACATGTGAAAATGTGAATGATGTGAACCATGTGAAAATGTGAACATGTGAAATGTGAATCAGAGAGCCCCCTAAATAGGCGTGCATGTGAAGATGTGAAACGATGTGAAAATATGTGAAAGCGTATGTGAAAAATGTGAAATGTGAAATGTGAATGATGTGAAACTATGTGAAATGTGAATAATGTGAAGAGATGTGAAGATGTGAAGATGTGAAGGTATGTGAACATGTGAATATGTGAAAGTATATGTGAATATGTGAAATGTGAATTGATGTGAAGGATGTGAATACTCGAATGTGAAATGTGAACTGCATGTGAATAATGTGAACGATGTGAACCCAATGTGAACCCTCGCATGTGAATACGAATGTGAACATGTGAAAATGTGAAGTAGCTCGGGATCATGTGAAATGTGAATATGTGAAATGTGAACATGTGAATTAAGGGATGTGAACAGCCCCCATGTGAACTATGTGAAGCAACATCATGTGAAATGTGAACATGTGAAATGTGAAAGATGTGAAGCATGTGAAGATGTGAAATGTGAATAGCATGTGAAATGTGAAATGTGAAAATGTGAAATGTGAAAATGTGAAGATGTGAACGGATGTGAAAAGATAGGGGTCATAAATGTGAATAGATGTGAAGATGTGAAATTATGTGAAATGTGAATGGGGATGACGATGTGAAAGAGGAAGTATGTGAACAGGTACATGTGAATATGTGAAGAAATGTGAAAGGATGTGAAATGTGAACATGTGAAGATGTGAAGGCCGAAAACAATGTGAAGACATGTGAATTATGTGAATTCGGTCGATGTGAAGAGGATGTGAAATGTGAATGATGTGAAATGTGAATTATGTGAACGTAAATGTGAATTTATGTGAAATGTGAATTGAATGTGAAGCATGTGAAGTAATGTGAATTTCCGAATATATGTGAAATGTGAAATAAATGTGAATATGTGAAATGTGAAACATGTGAAGATGTGAATCATGTGAAATGTGAAGATGTGAACATGTGAACGATGTGAATATGTGAAATGTGAACAGATGTGAAACATGTGAAATGTGAAGATGTGAATTATGTGAAGATGTGAAAATGTGAACACATGTGAAGAGTGGTCATAAACATGTGAAATGTGAAGAGGCGTAATGTGAAAATGTGAACTATGTGAAGTAAATGTGAAGATTGCAAGATGTGAATGAATGTGAATTATGTGAAGGATGTGAAACATTAATGTGAACAATGTGAATATGTGAAATGTGAAATGTGAATTGCATTATGTGAAAAGTTATGTGAAGATGTGAAACGATGTGAAATGTGAAATGTGAAATGTGAACCGCGAAATAGTTGATGTGAACGATGTGAAATGTGAAATGTGAATATGTGAAATGTGAACCATGTGAAATAATGTGAATAATGTGAATGTATGTGAATTAGAATGTGAAATGTGAAGTAGCTTCGGAATGTGAAAAGATGTGAAGTATGTGAACATGTGAAAATGTGAAGATATATGTGAAGGAAATGTGAAGGGATGTGAAATGTGAAGCCATGTGAAATATGTGAAATGTGAAATGTGAAGTCTGGATGTGAAATGTGAATATGTGAACCGTAATGTGAAATGTGAAAGGTGCCGTCTAGGATATTCTATGTGAACGATGTGAAACAATCTACATGTGAAATGTGAAAGGGATGTGAACTTGAATGTGAATGGATGTGAAAACGACATGTGAATATAACACCGCTCTGGCCCATGTGAACAATGTGAATATGTGAACAATGTGAAAACGATGTGAACAGGATGTGAAAATGTGAAAAATGTGAACCATGTGAAATGGATGTGAAAAATGTGAAAATGTGAAATGTGAAAGATGTGAAGATGTGAACCTGATGTGAATTACTTATGTGAAGGATGTGAATTTGATGTGAAGAAATGTGAAGTGGATGTGAAATGTGAACTACCACATGTGAAATGTGAAATGTGAACTAATGTGAACCGATGTGAACCATATGTGAAATTCCATGTGAAATGTGAAGCAATGTGAAATGTGAAGATGTGAACACATGTGAAATGTGAACCATGTGAAATGTGAAATGTGAAGATGTGAAATGTGAAGTAATGTGAAATGTGAAAAATCATGTGAAGAACTATATGTGAAAACATGTGAATAATGTGAACGGATGTGAATGGGATGTGAAGATGTGAAGGGCATGTGAATATGTGAAATGTGAATTCCCCGTGCGCCACGATGTGAAGCAATGTGAATGATATGTGAATTAATGTGAACAGAAGGATGTGAATCATTTCTCGTAATGTGAACGAGGATGTGAAAATGTGAAACGAGACATGTGAAATGTGAAGCACAATGTGAAGATGTGAAGCCTCCTAATGTGAAATCTGAAGATATGTGAACAATGTGAAAAGTTCGTATGTGAAATGTGAAATGTGAAATTGATGTGAAAAAAGTGGATGTGAAGCCGAATGTGAATATGTGAAGATGTGAAGGGATGTGAAAATGTGAAGTGCATCATGTGAAAATGTGAAATGTGAAATGTGAAGTGATGTGAATATGTGAACATGTGAACATGTGAAATGTGAAGGGCTATGTGAAAGATGTGAACATGTGAAAATTGGATGTGAATATGTGAAATGTGAAACACCCGGTTATGTGAAATGTGAAGTATGTGAAATGTGAAGATGTGAACTCTGCATGTGAATGGCCCATGTGAATCCATGTGAATCCATGTGAACAATGATCGCCAGCAGCCTATGTGAAATGTGAACCTGATGTGAAATGTGAAGCGATGTGAATGGTAATGTGAACATGTGAATCAACTATGTGAATATGTGAAATGTGAAGTGATGTGAATCCCGCGTGATGTGAAAATGTGAACTTATGTGAAACCATGTGAAAAATGTGAACGTATGTGAACATGTGAAAATGTGAAATCGACCGATGTGAAATGTGAAATGTGAATACGTATGTGAAATGTGAACCATGTGAACGATGTGAACTGCATGTGAAGATGATGTGAAATATGTGAATATCAATGTGAAAATGTGAAATGCATGTGAAATGTGAACTAGATGTGAACAATGTGAAACATTGAATGTGAAGATGTGAATTATGTGAAGATGTGAATCCATGTGAACCCAAGGATGTGAAAGATGTGAAGTAGCGCAATGTGAAAGATGTGAAAATGATGTGAACATGTGAAATGTGAAGGGCATGTGAACGATACGGGGATTTCGCCGCCGATGTGAAATGTGAAATGTGAATAGATGTGAAGAATGTGAACATGTGAAGATGTGAAATATTATGTGAAAATGTGAAAGATGTGAAGGATATGTGAAAGGCCATGCAATGTGAATCTATAGTTTATGTGAAATGTGAAACATGATGTGAAAGACAATGTGAAATTATGTGAATATGTGAACGCACGAATGTGAAGGTGTACGACCATGTGAAAGATGTGAAATGTGAACAGCCTATTGCATGTGAATTTTATCTCCCACATGTGAAGACATGTGAACAGCGAGCGATGTGAACCATGTGAAGTCGACTATGTGAATGCCGTATGTGAACTCTATGTGAATATGTGAAATGTGAATTGTACCTAACGGCATGTGAAATGTGAAG";
// console.log(ClumpFinding(genome, 1, 2, 20));

export default ClumpFinding;
